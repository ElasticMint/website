{"id":434,"date":"2021-05-04T09:26:29","date_gmt":"2021-05-04T08:26:29","guid":{"rendered":"https:\/\/www.elasticmint.com\/?p=434"},"modified":"2024-11-25T07:24:13","modified_gmt":"2024-11-25T07:24:13","slug":"coding-tip-making-code-readable-with-extension-methods","status":"publish","type":"post","link":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/","title":{"rendered":"Coding Tip &#8211; Making Code Readable with Extension Methods"},"content":{"rendered":"<p>Extension methods have been available in C# for many years now. As with all language features they are open to abuse, but used well they can enable developers to produce fluent interfaces and stateless methods for reuse.<\/p>\n<p>One of my bugbears is code that is hard to understand. Or more accurately code I have to think about in order to understand.<\/p>\n<h2>Configuring Services in Application Startup<\/h2>\n<p>Take the Startup class in ASP .Net Core APIs. In the <em>ConfigureServices() <\/em>method there is often a lot of code adding services to the <em>IServiceCollection<\/em> to enable Dependency Injection. This code can be overwhelming when you first look at it. E.g.<\/p>\n<pre>services\r\n    .AddScoped&lt;IMyService, MyService&gt;()\r\n    .AddScoped&lt;IMyService2, MyService2&gt;()\r\n    .AddScoped&lt;IMyService3, MyService3&gt;() \r\n    ...<\/pre>\n<p>I like to organise code according to the functionality it supports. Many of these services support a specific area of functionality. A well-named extension method placed in the folder for a particular piece of functionality makes it easy to group configuring services it relies on together. The intention of the code in the <em>ConfigureServices() <\/em>method then becomes much easier to understand. E.g.<\/p>\n<pre>services\r\n    .AddFeature1()\r\n    .AddFeature2()\r\n    .AddFeature3()\r\n    ...<\/pre>\n<p>&nbsp;<\/p>\n<h2>Dynamically Building Database Queries<\/h2>\n<p>Another area I find extension methods useful is with dynamically building up queries using the Elasticsearch Nest client or the MongoDB Driver. Very often, I have to build a query based on an optional parameter in the request. This can lead to lots of if statements checking for the parameter. If the parameter is present the query is then extended. E.g.<\/p>\n<pre>var filter = Builders&lt;MyCollection&gt;.Filter.Empty;\r\n\r\nif (property1!= null)\r\n{\r\n    filter &amp;= Builders&lt;MyCollection&gt;.Filter.Eq(x =&gt; x.Property1, property1);\r\n}\r\n\r\n...<\/pre>\n<p>Very quickly this code can become so long and unreadable that it&#8217;s hard to understand what the intention is. Moving this code into extension methods leads to code like this where the intention is much clearer.<\/p>\n<pre>var filter = Builders&lt;MyCollection&gt;.Filter\r\n    .Empty\r\n    .ByProperty1(property1)\r\n    .ByProperty2(property2) \r\n    ...;<\/pre>\n<p>The obvious benefit to all this is that it helps the next person who works on this to quickly understand what the code is trying to do. It&#8217;s easier to make changes and there are likely to be fewer bugs.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>Extension methods have been available in C# for many years now. As with all language features they are open to abuse, but used well they can enable developers to produce fluent interfaces and stateless methods for reuse. One of my &hellip; <a href=\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\">Continue reading <span class=\"meta-nav\">&rarr;<\/span><\/a><\/p>\n","protected":false},"author":6,"featured_media":243,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_acf_changed":false,"footnotes":""},"categories":[1],"tags":[],"class_list":["post-434","post","type-post","status-publish","format-standard","has-post-thumbnail","hentry","category-uncategorized"],"acf":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v25.4 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Coding Tip - Making Code Readable with Extension Methods - Elastic Mint<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\" \/>\n<meta property=\"og:locale\" content=\"en_GB\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Coding Tip - Making Code Readable with Extension Methods - Elastic Mint\" \/>\n<meta property=\"og:description\" content=\"Extension methods have been available in C# for many years now. As with all language features they are open to abuse, but used well they can enable developers to produce fluent interfaces and stateless methods for reuse. One of my &hellip; Continue reading &rarr;\" \/>\n<meta property=\"og:url\" content=\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\" \/>\n<meta property=\"og:site_name\" content=\"Elastic Mint\" \/>\n<meta property=\"article:published_time\" content=\"2021-05-04T08:26:29+00:00\" \/>\n<meta property=\"article:modified_time\" content=\"2024-11-25T07:24:13+00:00\" \/>\n<meta property=\"og:image\" content=\"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg\" \/>\n\t<meta property=\"og:image:width\" content=\"2560\" \/>\n\t<meta property=\"og:image:height\" content=\"1704\" \/>\n\t<meta property=\"og:image:type\" content=\"image\/jpeg\" \/>\n<meta name=\"author\" content=\"Andy\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<meta name=\"twitter:creator\" content=\"@elasticmint\" \/>\n<meta name=\"twitter:site\" content=\"@elasticmint\" \/>\n<meta name=\"twitter:label1\" content=\"Written by\" \/>\n\t<meta name=\"twitter:data1\" content=\"Andy\" \/>\n\t<meta name=\"twitter:label2\" content=\"Estimated reading time\" \/>\n\t<meta name=\"twitter:data2\" content=\"2 minutes\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"Article\",\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#article\",\"isPartOf\":{\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\"},\"author\":{\"name\":\"Andy\",\"@id\":\"https:\/\/www.elasticmint.com\/#\/schema\/person\/526698f5827a951afc3220bf4d37d08e\"},\"headline\":\"Coding Tip &#8211; Making Code Readable with Extension Methods\",\"datePublished\":\"2021-05-04T08:26:29+00:00\",\"dateModified\":\"2024-11-25T07:24:13+00:00\",\"mainEntityOfPage\":{\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\"},\"wordCount\":323,\"publisher\":{\"@id\":\"https:\/\/www.elasticmint.com\/#organization\"},\"image\":{\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage\"},\"thumbnailUrl\":\"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg\",\"articleSection\":[\"Uncategorized\"],\"inLanguage\":\"en-GB\"},{\"@type\":\"WebPage\",\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\",\"url\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\",\"name\":\"Coding Tip - Making Code Readable with Extension Methods - Elastic Mint\",\"isPartOf\":{\"@id\":\"https:\/\/www.elasticmint.com\/#website\"},\"primaryImageOfPage\":{\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage\"},\"image\":{\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage\"},\"thumbnailUrl\":\"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg\",\"datePublished\":\"2021-05-04T08:26:29+00:00\",\"dateModified\":\"2024-11-25T07:24:13+00:00\",\"breadcrumb\":{\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#breadcrumb\"},\"inLanguage\":\"en-GB\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/\"]}]},{\"@type\":\"ImageObject\",\"inLanguage\":\"en-GB\",\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage\",\"url\":\"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg\",\"contentUrl\":\"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg\",\"width\":2560,\"height\":1704},{\"@type\":\"BreadcrumbList\",\"@id\":\"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#breadcrumb\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https:\/\/www.elasticmint.com\/\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Coding Tip &#8211; Making Code Readable with Extension Methods\"}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/www.elasticmint.com\/#website\",\"url\":\"https:\/\/www.elasticmint.com\/\",\"name\":\"Elastic Mint Bespoke Software Development company in Bristol offering Software Development and IT Consultancy\",\"description\":\"A refreshing approach to bespoke software development\",\"publisher\":{\"@id\":\"https:\/\/www.elasticmint.com\/#organization\"},\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/www.elasticmint.com\/?s={search_term_string}\"},\"query-input\":{\"@type\":\"PropertyValueSpecification\",\"valueRequired\":true,\"valueName\":\"search_term_string\"}}],\"inLanguage\":\"en-GB\"},{\"@type\":\"Organization\",\"@id\":\"https:\/\/www.elasticmint.com\/#organization\",\"name\":\"Elastic Mint Bespoke Software Development company in Bristol offering Software Development and IT Consultancy\",\"url\":\"https:\/\/www.elasticmint.com\/\",\"logo\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-GB\",\"@id\":\"https:\/\/www.elasticmint.com\/#\/schema\/logo\/image\/\",\"url\":\"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2023\/02\/LOGO_mint-back.jpg\",\"contentUrl\":\"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2023\/02\/LOGO_mint-back.jpg\",\"width\":1500,\"height\":1060,\"caption\":\"Elastic Mint Bespoke Software Development company in Bristol offering Software Development and IT Consultancy\"},\"image\":{\"@id\":\"https:\/\/www.elasticmint.com\/#\/schema\/logo\/image\/\"},\"sameAs\":[\"https:\/\/x.com\/elasticmint\",\"https:\/\/www.linkedin.com\/company\/elastic-mint-ltd\/\"]},{\"@type\":\"Person\",\"@id\":\"https:\/\/www.elasticmint.com\/#\/schema\/person\/526698f5827a951afc3220bf4d37d08e\",\"name\":\"Andy\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-GB\",\"@id\":\"https:\/\/www.elasticmint.com\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/6362b9f5d9db9f5240bd5b9df62c892634f001fb7477495c6a0b6638be496c9f?s=96&d=mm&r=g\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/6362b9f5d9db9f5240bd5b9df62c892634f001fb7477495c6a0b6638be496c9f?s=96&d=mm&r=g\",\"caption\":\"Andy\"},\"url\":\"https:\/\/www.elasticmint.com\/author\/andy\/\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Coding Tip - Making Code Readable with Extension Methods - Elastic Mint","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/","og_locale":"en_GB","og_type":"article","og_title":"Coding Tip - Making Code Readable with Extension Methods - Elastic Mint","og_description":"Extension methods have been available in C# for many years now. As with all language features they are open to abuse, but used well they can enable developers to produce fluent interfaces and stateless methods for reuse. One of my &hellip; Continue reading &rarr;","og_url":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/","og_site_name":"Elastic Mint","article_published_time":"2021-05-04T08:26:29+00:00","article_modified_time":"2024-11-25T07:24:13+00:00","og_image":[{"width":2560,"height":1704,"url":"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg","type":"image\/jpeg"}],"author":"Andy","twitter_card":"summary_large_image","twitter_creator":"@elasticmint","twitter_site":"@elasticmint","twitter_misc":{"Written by":"Andy","Estimated reading time":"2 minutes"},"schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"Article","@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#article","isPartOf":{"@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/"},"author":{"name":"Andy","@id":"https:\/\/www.elasticmint.com\/#\/schema\/person\/526698f5827a951afc3220bf4d37d08e"},"headline":"Coding Tip &#8211; Making Code Readable with Extension Methods","datePublished":"2021-05-04T08:26:29+00:00","dateModified":"2024-11-25T07:24:13+00:00","mainEntityOfPage":{"@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/"},"wordCount":323,"publisher":{"@id":"https:\/\/www.elasticmint.com\/#organization"},"image":{"@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage"},"thumbnailUrl":"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg","articleSection":["Uncategorized"],"inLanguage":"en-GB"},{"@type":"WebPage","@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/","url":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/","name":"Coding Tip - Making Code Readable with Extension Methods - Elastic Mint","isPartOf":{"@id":"https:\/\/www.elasticmint.com\/#website"},"primaryImageOfPage":{"@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage"},"image":{"@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage"},"thumbnailUrl":"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg","datePublished":"2021-05-04T08:26:29+00:00","dateModified":"2024-11-25T07:24:13+00:00","breadcrumb":{"@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#breadcrumb"},"inLanguage":"en-GB","potentialAction":[{"@type":"ReadAction","target":["https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/"]}]},{"@type":"ImageObject","inLanguage":"en-GB","@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#primaryimage","url":"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg","contentUrl":"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2021\/01\/desktop-glasses-scaled.jpg","width":2560,"height":1704},{"@type":"BreadcrumbList","@id":"https:\/\/www.elasticmint.com\/coding-tip-making-code-readable-with-extension-methods\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/www.elasticmint.com\/"},{"@type":"ListItem","position":2,"name":"Coding Tip &#8211; Making Code Readable with Extension Methods"}]},{"@type":"WebSite","@id":"https:\/\/www.elasticmint.com\/#website","url":"https:\/\/www.elasticmint.com\/","name":"Elastic Mint Bespoke Software Development company in Bristol offering Software Development and IT Consultancy","description":"A refreshing approach to bespoke software development","publisher":{"@id":"https:\/\/www.elasticmint.com\/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/www.elasticmint.com\/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-GB"},{"@type":"Organization","@id":"https:\/\/www.elasticmint.com\/#organization","name":"Elastic Mint Bespoke Software Development company in Bristol offering Software Development and IT Consultancy","url":"https:\/\/www.elasticmint.com\/","logo":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https:\/\/www.elasticmint.com\/#\/schema\/logo\/image\/","url":"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2023\/02\/LOGO_mint-back.jpg","contentUrl":"https:\/\/www.elasticmint.com\/wp-content\/uploads\/2023\/02\/LOGO_mint-back.jpg","width":1500,"height":1060,"caption":"Elastic Mint Bespoke Software Development company in Bristol offering Software Development and IT Consultancy"},"image":{"@id":"https:\/\/www.elasticmint.com\/#\/schema\/logo\/image\/"},"sameAs":["https:\/\/x.com\/elasticmint","https:\/\/www.linkedin.com\/company\/elastic-mint-ltd\/"]},{"@type":"Person","@id":"https:\/\/www.elasticmint.com\/#\/schema\/person\/526698f5827a951afc3220bf4d37d08e","name":"Andy","image":{"@type":"ImageObject","inLanguage":"en-GB","@id":"https:\/\/www.elasticmint.com\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/6362b9f5d9db9f5240bd5b9df62c892634f001fb7477495c6a0b6638be496c9f?s=96&d=mm&r=g","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/6362b9f5d9db9f5240bd5b9df62c892634f001fb7477495c6a0b6638be496c9f?s=96&d=mm&r=g","caption":"Andy"},"url":"https:\/\/www.elasticmint.com\/author\/andy\/"}]}},"_links":{"self":[{"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/posts\/434","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/users\/6"}],"replies":[{"embeddable":true,"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/comments?post=434"}],"version-history":[{"count":0,"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/posts\/434\/revisions"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/media\/243"}],"wp:attachment":[{"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/media?parent=434"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/categories?post=434"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/www.elasticmint.com\/wp-json\/wp\/v2\/tags?post=434"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}